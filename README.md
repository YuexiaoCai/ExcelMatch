# ExcelMatch

[TOC]

## 一、环境说明

- 运行环境`python3.8`，开发环境`VS2017`
- 引用库文件`re`,`openpyxl 3.5.0`
- 源文件表格需要放在`py`文件下



## 二、代码使用说明

使用前请在`cmd`下输入：

```
python --version
pip list
```
检查环境是否安装正确

随后进入`ExcelMatch.py`所在的目录，输入：
```
py ExcelMatch.py
```

会分析自动生成`学习名单.xlsx`和`班级情况.xlsx`两个表格。



## 三、代码设计说明

代码根据正则匹配，获取输入信息，切分为`学号+姓名`，目前支持的匹配模式有：

- 学号匹配（准确）
- 学号+姓名匹配（准确）
- 姓名匹配（不准确）

因此建议保证学号填写正确，姓名为辅助匹配项。


对于自动生成的表格`学习名单.xlsx`，填充内容为`1`则该生在青年大学习名单中，为`0`反之。



## 四、注意事项

- ```python
  #代码开头硬编码了输入文件名，考虑到使用命令行控制可能会引入更多模块，需要更改输入文件时，请手动修改文件名。
  #line5-6
  wb_input = load_workbook(filename='南航-计算机科学与技术学院.xlsx')
  wb_output = load_workbook(filename='StudentList.xlsx')
  ```

- ```python
  #正则表达式匹配学号为9个数字，匹配姓名为2~9个中文字符，考虑到实际情况可能会有同学名字中间带点，建议以学号匹配的结果为准。
  #line17-18
  str_id = re.compile(r'\d{9}')
  str_name = re.compile(r'[\u4e00-\u9fa5]{2,9}')
  ```

- ```python
  #单元格的字母标号按照给的样例文件进行设定的，如果输入文件字母标号不一致，可能需要手动修改代码中所有`ABCDEFG`的标号，以及for循环的起始地址
  ```

- ```python
  #班级情况统计的时候，原先计划手动输入所有班级，然后进行统计。考虑到这样做会比较麻烦，现在改为了自动从学生名单的班级编号中获取名单。为了简化代码设计，分析本行的班级是否与上行的班级相同，如果不同就视为上一个班级结束，输出一遍信息。因此，请事先将表格按照班级进行排序，以免出现同一个班级分开统计的情况。
  ```



## 五、更新说明

|    版本编号      | 更新内容                   | 更新时间        |
| ---------- | -------------------------- | --------------- |
| v0.1     | 将新增表单改为新增工作簿方式     | 2019.10.20 0:48 |
| v0.2     | 修改为纯字符串比较，解决班级人数全0的问题     | 2019.10.20 1:02 |
| v0.3     | 增加for循环宽度，解决未录入末尾同学的问题     | 2019.10.20 1:20 |
| v0.4     | 增加for循环宽度，解决缺失班级的问题     | 2019.10.20 1:35 |
| v0.5     | 修改表格标号，解决双参数统计异常的问题     | 2019.10.20 1:53 |
| v0.6     | 增添功能：或匹配     | 2019.10.20 1:59 |
| v0.7     | 取消学号/姓名单匹配，将双参数或匹配作为默认检索方式；优化代码和结果呈现形式;修改文档     | 2019.10.29 13:50 |
| v0.8     | 增加检索前强制类型转换，解决纯数字无法匹配的问题     | 2019.11.09 14:10 |

## 六、遗留缺陷

- 没有解决重名学生的身份确定问题
- 青年大学习导出源文件缺乏正常的文件签名，需要打开excel文件后点击保存，否则openpyxl库函数无法打开该文件，将会报错
- 使用pyinstaller进行.py脚本封装时报错，暂时未能转换成为.exe/.app文件。如需使用，请先正确配置环境。
